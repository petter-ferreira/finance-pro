<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Empr√©stimos</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <!-- Mobile Header -->
    <header class="mobile-header">
        <h1>üíé FinancePro</h1>
        <div id="header-actions">
            <div id="user-profile-mobile" style="display:flex; align-items:center; gap:10px; cursor:pointer;"
                onclick="logout()" title="Clique para Sair">
                <!-- Filled by JS -->
            </div>
        </div>
    </header>

    <!-- Desktop Sidebar (Visually hidden on mobile via CSS) -->
    <aside>
        <h1>üíé FinancePro</h1>
        <nav>
            <button class="active" onclick="showSection('dashboard')">
                <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor" style="margin-right: 10px;">
                    <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z" />
                </svg>
                Dashboard
            </button>
            <button onclick="showSection('clients')">
                <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor" style="margin-right: 10px;">
                    <path
                        d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                </svg>
                Clientes
            </button>
            <button onclick="showSection('loans')">
                <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor" style="margin-right: 10px;">
                    <path
                        d="M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z" />
                </svg>
                Empr√©stimos
            </button>
            <button onclick="showSection('reports')">
                <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor" style="margin-right: 10px;">
                    <path
                        d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14zM7 10h2v7H7zm4-3h2v10h-2zm4 6h2v4h-2z" />
                </svg>
                Relat√≥rios
            </button>
        </nav>
    </aside>

    <main>
        <!-- Dashboard Section -->
        <div id="dashboard" class="section active">
            <h2>Vis√£o Geral</h2>
            <div class="card-grid">
                <div class="card">
                    <p>Total Emprestado</p>
                    <div class="balance" id="total-loaned">R$ 0,00</div>
                </div>
                <div class="card">
                    <p>Juros Recebidos</p>
                    <div class="balance" id="total-interest">R$ 0,00</div>
                </div>
                <div class="card">
                    <p>Clientes Ativos</p>
                    <div class="balance" id="total-clients">0</div>
                </div>
            </div>
        </div>

        <!-- Clients Section -->
        <div id="clients" class="section">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <h2>Meus Clientes</h2>
                <button class="btn-primary desktop-only" style="width: auto; padding: 0.5rem 1rem; margin: 0;"
                    onclick="openModal('modal-add-client')">+ Novo Cliente</button>
            </div>
            <div id="clients-list" class="card-grid">
                <!-- Filled by JS -->
            </div>
            <!-- FAB for Mobile -->
            <button class="fab mobile-only" onclick="openModal('modal-add-client')">+</button>
        </div>

        <!-- Loans Section -->
        <div id="loans" class="section">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <h2>Empr√©stimos</h2>
                <button class="btn-primary desktop-only" style="width: auto; padding: 0.5rem 1rem; margin: 0;"
                    onclick="openModal('modal-new-loan')">+ Novo Empr√©stimo</button>
            </div>
            <div id="loans-list" class="card-grid">
                <!-- Filled by JS -->
            </div>
            <!-- FAB for Mobile -->
            <button class="fab mobile-only" onclick="openModal('modal-new-loan')">+</button>
        </div>

        <!-- Reports Section -->
        <div id="reports" class="section">
            <h2>Hist√≥rico</h2>
            <div class="card" style="padding: 0; overflow: hidden;">
                <table id="reports-table">
                    <thead>
                        <tr>
                            <th style="padding-left:1rem;">Data</th>
                            <th>Nome</th>
                            <th style="padding-right:1rem; text-align:right;">Valor</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Filled by JS -->
                    </tbody>
                </table>
            </div>
        </div>
    </main>

    <!-- Bottom Navigation (Mobile Only) -->
    <nav class="bottom-nav">
        <button class="nav-item active" onclick="showSection('dashboard')">
            <svg viewBox="0 0 24 24">
                <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z" />
            </svg>
            <span>In√≠cio</span>
        </button>
        <button class="nav-item" onclick="showSection('clients')">
            <svg viewBox="0 0 24 24">
                <path
                    d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
            </svg>
            <span>Clientes</span>
        </button>
        <button class="nav-item" onclick="showSection('loans')">
            <svg viewBox="0 0 24 24">
                <path
                    d="M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z" />
            </svg>
            <span>Empr√©stimos</span>
        </button>
        <button class="nav-item" onclick="showSection('reports')">
            <svg viewBox="0 0 24 24">
                <path
                    d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14zM7 10h2v7H7zm4-3h2v10h-2zm4 6h2v4h-2z" />
            </svg>
            <span>Relat.</span>
        </button>
    </nav>

    <!-- Modals -->

    <!-- Add Client Modal -->
    <div id="modal-add-client" class="modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('modal-add-client')">&times;</button>
            <h3>Novo Cliente</h3>
            <form id="form-add-client">
                <input type="text" name="name" placeholder="Nome Completo" required>
                <input type="tel" name="cpf_rg" placeholder="CPF ou RG" required>
                <input type="tel" name="phone" placeholder="Telefone">
                <input type="text" name="address" placeholder="Endere√ßo">
                <!-- Custom File Upload Button could be better but standard is ok for now -->
                <input type="file" name="photo">
                <button type="submit" class="btn-primary">Salvar Cliente</button>
            </form>
        </div>
    </div>

    <!-- New Loan Modal -->
    <div id="modal-new-loan" class="modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('modal-new-loan')">&times;</button>
            <h3>Novo Empr√©stimo</h3>
            <form id="form-new-loan">
                <select id="select-customer" name="customer_id" required>
                    <option value="">Selecione o Cliente</option>
                    <!-- Filled by JS -->
                </select>
                <input type="number" name="amount" placeholder="Valor (R$)" step="0.01" inputmode="decimal" required>
                <input type="number" name="interest_rate" placeholder="Juros Di√°rio (%)" step="0.1" inputmode="decimal"
                    required>
                <button type="submit" class="btn-primary">Criar Empr√©stimo</button>
            </form>
        </div>
    </div>

    <!-- Pay/Update Loan Modal -->
    <div id="modal-loan-action" class="modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('modal-loan-action')">&times;</button>
            <h3 id="loan-action-title">Gerenciar</h3>
            <div id="loan-details"
                style="margin-bottom: 1.5rem; color: #94a3b8; font-size: 1.1rem; text-align: center;"></div>

            <button class="btn-primary" style="background: #3b82f6; margin-bottom: 1.5rem;"
                onclick="triggerInterestUpdate()">üîÑ Atualizar Juros do Dia</button>

            <form id="form-payment">
                <h4 style="margin-bottom:1rem;">Registrar Pagamento</h4>
                <input type="hidden" name="loan_id" id="payment-loan-id">
                <select name="type" required>
                    <option value="INTEREST_ONLY">Somente Juros</option>
                    <option value="PRINCIPAL_AND_INTEREST">Amortiza√ß√£o / Total</option>
                </select>
                <input type="number" name="amount" placeholder="Valor (R$)" step="0.01" inputmode="decimal" required>
                <button type="submit" class="btn-primary">Confirmar Pagamento</button>
            </form>
        </div>
    </div>

    <script src="app.js"></script>
</body>

</html>